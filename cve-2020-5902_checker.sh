#!/bin/bash
# Author: cbk914
# Simple script to find F5 BIG IP devices vulnerable to CVE-2020-5902
# Dependencies: 
# Nmap https://github.com/nmap/nmap  
# NSE script: https://raw.githubusercontent.com/RootUp/PersonalStuff/master/http-vuln-cve2020-5902.nse
# Nuclei: https://github.com/projectdiscovery/nuclei
# Template: https://github.com/projectdiscovery/nuclei-templates/blob/master/cves/CVE-2020-5902.yaml


print_green() {
    BOLD_GREEN=$(tput bold ; tput setaf 2)
    NORMAL=$(tput sgr0)
    echo "${BOLD_GREEN}$1${NORMAL}"
}

print_yellow() {
    BOLD_YELLOW=$(tput bold ; tput setaf 3)
    NORMAL=$(tput sgr0)
    echo "${BOLD_YELLOW}$1${NORMAL}"
}

print_red() {
    BOLD_YELLOW=$(tput bold ; tput setaf 1)
    NORMAL=$(tput sgr0)
    echo "${BOLD_YELLOW}$1${NORMAL}"
}

print_blue() {
    BOLD_YELLOW=$(tput bold ; tput setaf 4)
    NORMAL=$(tput sgr0)
    echo "${BOLD_YELLOW}$1${NORMAL}"
}

print_delimiter() {
    echo
    echo "-------------------------------------------------------------------------------"
    echo
}


clear
print_green "###############################################################"
print_green "# CVE-2020-5902 CHECKER                                       #"
print_green "###############################################################"
print_delimiter

print_yellow "[*] TARGET IP/CIDR RANGE?"
print_delimiter
read RANGE

print_blue "[+] GENERATING LIST OF DETECTED F5 BIG IP DEVICES..."
nmap -p443 $RANGE --script=http-vuln-cve2020-5902.nse -oG - | awk '/Up$/{print $2}' > targets.txt

print_green "[+] LIST GENERATED"

sleep 3

print_blue "[+] SCANNING TARGETS' LIST FOR VULNERABLE DEVICES"
nuclei -t ~/AXA/Tools/Frameworks/nuclei/nuclei-templates/cves/CVE-2020-5902.yaml -l targets.txt
# Change Nuclei's template directory for your own

exit 0

