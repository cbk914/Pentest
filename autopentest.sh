#!/bin/bash

LOCAL="/usr/local/bin"
TMP="/tmp"
echo "[+] Target IP/host?\n"
read target

echo "[*] Checking WAF protection..."
# 0. WAF testing
wafw00f $target > $TMP/wafw00f+$target.log

echo "[*] Surface recon checks..."
# 1. Surface Recon
# 1.1 Services and fingerprint 
sudo nmap -p- -sC -sV -Pn -T5 $target -oX $TMP/$target.xml
echo "[*] Checking SSL/TLS certificates..."
# 1.2 TLS/SSL certificates
$LOCAL/testssl $target > $target.ssl
echo "[*] Checking CORS..."
# 1.3 CORS
echo "[+] Header?\n"
read header
echo "[+] Origin?\n"
read origin
python $LOCAL/corser.py -u $target -header $header -origin $origin -poc -fuzz
# 1.4 XSRF 
echo "[*] Checking CSRF..."
echo "[+] Burp Collaborator URL?\n"
read burp

# $LOCAL/xsrfprobe


