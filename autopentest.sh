#!/bin/bash
# Copyleft 2020 by cbk914
# Half-interactive-half-automated script for the first phases of a pentest
# Time is money, and money is a Burp Suite license :)

# Resources needed:
# TO-DO: checker and installer 
# ·wafw00f
# ·nmap
# ·testssl
# ·dirb
# ·gobuster
# ·crossdomain (corser)
# ·spiderfoot
# ·searchsploit

TIMESTAMP=`date +%Y%m%d%H%M%S`
LOCAL="/usr/local/bin"
TMP="/tmp"
OPT="/opt"
echo "[+] Target IP/host?\n"
read -p target

echo "[*] Checking WAF protection..."
# 0. WAF testing

wafw00f $target > $TMP/$TIMESTAMP+"_"+$target.log &
curl -v --anyauth --connect-timeout 15 -c cookie.jar

echo "[*] Surface recon checks..."
# 1. Surface Recon
# 1.1 Services and fingerprint 
sudo nmap -p- -sC -O -sV -Pn -T5 $target -oX $TMP/$TIMESTAMP+"_"+$target.+"_nmap.xml" &
echo "[*] Checking SSL/TLS certificates..."
# 1.2 TLS/SSL certificates
$LOCAL/testssl $target > $TIMESTAMP+"_"+$target+"_ssl.log" &

# 1.3 Protocol checks

# Check headers


# Directory, endpoints and content discovery

# 2.1.1 Dirb

dirb $target -p 127.0.0.1:8080 -o $TMP/$TIMESTAMP+"_"+$target+"_dirb.log" &

# 2.1.2 goBuster

# 2.2 Sitemap

# 2.3 Basic response checks

# Basic common attacks checks

# 3.1 CORS
echo "[*] Checking CORS..."
echo "[+] Header?\n"
read header
echo "[+] Origin?\n"
read origin
python $LOCAL/corser.py -u $target -header $header -origin $origin -poc -fuzz
# 3.2 XSRF 
echo "[*] Checking CSRF..."
echo "[+] Burp Collaborator URL?\n"
read burp
# $LOCAL/xsrfprobe

# 3.3 XSS

# 3.4 SQLi

# 4. Basic vulnerability and exploit enumeration



